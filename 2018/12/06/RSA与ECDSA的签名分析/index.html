<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=""><title>RSA与ECDSA的签名分析 | Mr Bluyee's Blog</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/latest/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/grids-responsive-min.min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/latest/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement('script');
  hm.src = 'https://hm.baidu.com/hm.js?' + '3dbaf3043b34b1c894c4cd063629b6a9';
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();</script><script type="text/javascript" src="//lib.baomitu.com/clipboard.js/latest/clipboard.min.js"></script><script type="text/javascript" src="//lib.baomitu.com/toastr.js/latest/toastr.min.js"></script><link rel="stylesheet" href="//lib.baomitu.com/toastr.js/latest/toastr.min.css"><meta name="generator" content="Hexo 7.1.1"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">RSA与ECDSA的签名分析</h1><a id="logo" href="/.">Mr Bluyee's Blog</a><p class="description"></p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">RSA与ECDSA的签名分析</h1><div class="post-meta">2018-12-06<span> | </span><span class="category"><a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94Python/">学习笔记——Python</a></span><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 3.2k</span><span class="post-meta-item-text"> 字</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i><span class="post-count"> 17</span><span class="post-meta-item-text"> 分钟</span></span></span></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#BER%E7%BC%96%E7%A0%81"><span class="toc-number">1.</span> <span class="toc-text">BER编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RSA%E7%AD%BE%E5%90%8D"><span class="toc-number">2.</span> <span class="toc-text">RSA签名</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#HASH%E7%AE%97%E6%B3%95%E7%9A%84OID%E7%9A%84%E7%BC%96%E7%A0%81"><span class="toc-number">2.1.</span> <span class="toc-text">HASH算法的OID的编码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ECDSA%E7%AD%BE%E5%90%8D"><span class="toc-number">3.</span> <span class="toc-text">ECDSA签名</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#python-%E9%83%A8%E5%88%86%E4%BB%A3%E7%A0%81"><span class="toc-number">3.1.</span> <span class="toc-text">python 部分代码</span></a></li></ol></li></ol></div></div><div class="post-content"><h3 id="BER编码"><a href="#BER编码" class="headerlink" title="BER编码"></a>BER编码</h3><p>RSA与ECDSA的签名都采用了BER编码。<br>BER(Basic Encoding Rule)，BER的数据都是TLV格式的。</p>
<span id="more"></span>

<p>每种TAG的定义如下：</p>
<table>
<thead>
<tr>
<th>Tag</th>
<th>定义</th>
</tr>
</thead>
<tbody><tr>
<td>0x01</td>
<td>BOOL</td>
</tr>
<tr>
<td>0x02</td>
<td>INT，整型</td>
</tr>
<tr>
<td>0x04</td>
<td>OCTSTR，字符串类型</td>
</tr>
<tr>
<td>0x05</td>
<td>NULL，空类型</td>
</tr>
<tr>
<td>0x06</td>
<td>OBJID，对象标识ObjectID（在这里就是对应的HASH算法的OID编码）</td>
</tr>
<tr>
<td>0x0A</td>
<td>ENUM</td>
</tr>
<tr>
<td>0x30</td>
<td>SEQ，Sequence组合类型</td>
</tr>
<tr>
<td>0x31</td>
<td>SETOF</td>
</tr>
<tr>
<td>0x40</td>
<td>IPADDR</td>
</tr>
<tr>
<td>0x41</td>
<td>COUNTER</td>
</tr>
<tr>
<td>0x42</td>
<td>GAUGE</td>
</tr>
<tr>
<td>0x43</td>
<td>TIMETICKS</td>
</tr>
<tr>
<td>0x44</td>
<td>OPAQUE</td>
</tr>
</tbody></table>
<h3 id="RSA签名"><a href="#RSA签名" class="headerlink" title="RSA签名"></a>RSA签名</h3><p>RSA私钥签名时要基于某个HASH算法，比如MD5或者SHA1等。</p>
<p>RSA签名过程：先对明文做HASH计算，然后对HASH后的数据进行BER编码，再用私钥直接对编码后的数据加密。</p>
<p>RSA验签过程：先用公钥解密，解析TLV数据从中得到HASH算法的OID和HASH值，根据OID选择相应的HASH算法对明文进行计算，最后比对HASH值。</p>
<p>例子：<br>公钥模：<br>89 54 E6 61 C1 52 DB ED 07 57 50 04 AD B3 D2 A7 A9 8F E8 D8 20 5B 01 B2 E5 E4 7A 7B EE 80 E3 C0 13 11 D2 F9 AD C3 CC 5F 1D 96 AC B2 AB BE 9C 14 9E 76 31 06 B2 E6 FA 01 52 A7 2E 53 C2 1D 3B 7B 9B 68 05 D2 5E 35 31 98 0E 02 93 E0 D9 0C 38 2D 3D EE 10 E6 87 53 79 DF B2 1E 12 D9 9E EF 89 6D 01 59 0D 13 94 DB 05 B7 09 34 D3 5B AB ED 7C FE 0E BE 87 EE E8 DD 01 39 3A CA 3A A7 17 B8 AA E3</p>
<p>公钥指数：<br>01 00 01</p>
<p>私钥指数：<br>01 FE B1 BA 09 CC E2 54 F7 1E 55 93 3B D2 B8 E4 A6 99 E8 8F FB 28 57 45 FA 00 EF A6 8D 38 62 16 90 30 5A 18 36 65 F9 BA 07 FC 00 56 38 18 74 BB F7 F1 4F 95 01 54 49 9D 6B 4D F2 66 55 13 87 A1 A6 95 74 72 6A D8 3A EA 34 A8 F8 40 5F 27 11 30 4F 96 3A 2E 7B E6 B6 47 3C 3B 4D 24 E8 FA 51 19 59 FB 52 E0 9B D2 24 B3 B5 8A 36 BF 34 20 E9 2A AB 5D 55 9B 60 01 D5 04 81 E8 E7 EC B2 5F 81 41</p>
<p>私钥P：<br>BF 36 08 66 63 74 6A 79 D0 77 64 21 73 6D 1A B9 13 BB 35 13 BE A6 73 84 C8 7D 83 67 BE C2 F5 0C 3A 7F 5F EF 6E 73 E2 BC 31 D2 0C 78 06 D7 38 85 7E F5 06 40 62 A6 1D 53 CC 97 34 30 58 EE E2 05</p>
<p>私钥Q：<br>B7 DD 46 99 58 B2 52 4B 87 FB E1 F1 09 44 AB 9A AD D1 93 90 9C 40 E0 2F 36 63 F4 7F 49 CB 36 E3 2C DA 85 5C 6E CE 41 AC CB 09 6C 27 B6 44 2B D8 26 5F D5 63 DF 2A C8 60 57 3B 23 13 2B 5F 65 C7</p>
<p>私钥DP：<br>A6 EF C4 9B A7 9E DE CA E5 2F 27 33 71 33 C3 0D EC 65 18 2C D9 D9 36 A7 A9 E6 B2 CF E3 A3 10 10 12 0E 5C B2 8C 2B 0E BC 21 7E F2 35 E4 3B 08 74 BC 67 AD 82 8E DD DA 62 EC 0E E2 98 87 3C 60 05</p>
<p>私钥DQ：<br>B6 A0 8B A7 75 7A 6A 53 AB D6 7D 2E 35 CE 87 C5 34 31 9F 29 5C 8A F4 22 F1 1B 87 97 87 6C DA 2F FC 35 71 91 C6 5E 08 CD E1 3E 92 B7 3F 4B A7 61 23 7C BD 30 5E 52 D8 85 19 20 1C 4E C6 1E 13 B1</p>
<p>私钥InvQ：<br>B4 12 D6 05 1C 2C 2B 6F B5 73 99 F3 B7 A7 08 6F A3 E8 2D 6F 33 A6 AE E5 BE 7B 89 86 7F 48 3B DD BC 4A 07 BF A4 A1 BB 96 BD 0E 46 F1 43 FA FB DE A0 1B AB 38 7D 49 59 45 EE 8C F9 3D 89 CF EB AC</p>
<p>明文：<br>11 22 33 44 55</p>
<p>签名数据：<br>56 E1 5E 29 84 D6 BC FB 87 7F 55 93 B4 E1 F3 75 2C 64 A5 BC 04 3A D7 0A DB 84 AD 8B 9C 4D D8 E6 8A 56 85 7B 2C 5E 50 E5 81 EB DC 40 D8 9A 29 64 54 19 5B F0 2B 77 D3 DB CF A2 17 BF 33 3F 19 19 B0 FF 36 53 D3 C2 36 1D 90 43 27 2C 0F 54 34 54 F7 E8 D2 09 75 E4 F1 A0 8B F5 38 EA 66 D6 53 14 E4 C5 B6 5A C7 74 52 6E 0A 16 C6 9B B7 81 0B 06 61 8A E7 41 BB 97 E6 EE 3E 6A 1C 7A E6 32 18 60</p>
<p>用公钥对上面的数据解密后得到：<br>30 20 30 0C 06 08 2A 86 48 86 F7 0D 02 05 05 00 04 10 28 3D 4F EA 5D DE D5 9C F8 37 D3 04 73 28 F5 AF</p>
<p>解析其TLV格式：<br>30 20 30 0C 06 08 2A 86 48 86 F7 0D 02 05 05 00 04 10 28 3D 4F EA 5D DE D5 9C F8 37 D3 04 73 28 F5 AF<br><strong>第一级：</strong><br>tag: 30(Sequence组合类型) 长度：20<br>内容：<br>30 0C 06 08 2A 86 48 86 F7 0D 02 05 05 00 04 10 28 3D 4F EA 5D DE D5 9C F8 37 D3 04 73 28 F5 AF </p>
<p><strong>第二级：</strong><br>tag: 30(Sequence组合类型) 长度：0C<br>内容：<br>06 08 2A 86 48 86 F7 0D 02 05 05 00</p>
<p>tag: 04(字符串类型) 长度：10<br>内容：<br>28 3D 4F EA 5D DE D5 9C F8 37 D3 04 73 28 F5 AF<br>正好就是明文数据11 22 33 44 55的MD5值。</p>
<p><strong>第三级：</strong><br>tag: 06(对象标识ObjectID) 长度：08<br>内容：<br>2A 86 48 86 F7 0D 02 05 </p>
<p>tag: 05(空类型) 长度：00<br>内容：无</p>
<p>RSA每次基于不同的HASH算法对不同的数据进行签名时，构造的这一段BER数据的基本格式是固定不变的，只是HASH算法的OID和哈希值会变。</p>
<h4 id="HASH算法的OID的编码"><a href="#HASH算法的OID的编码" class="headerlink" title="HASH算法的OID的编码"></a>HASH算法的OID的编码</h4><p>每个算法的OID都是固定的一串十进制数据，是国际权威组织定的。<br>比如MD5的OID 是 1.2.840.113549.2.5   ，<br>表示为”iso(1) member-body (2) US (840) rsadsi(113549) digestAlgorithm (2) md5 (5)”, 所以当解码程序看到这个OID时,就知道是MD5散列。</p>
<p>对OID的编码规则如下：<br>前两部分如果定义为x.y, 那么它们将合成一个字40*x + y, 其余部分单独作为一个字节进行编码。<br>每个字首先被分割为最少数量的没有头零数字的7位数字。</p>
<p>这些数字以big-endian格式进行组织,并且一个接一个地组合成字节。<br>除了编码的最后一个字节外,其他所有字节的最高位(位8)都为1。</p>
<p>以MD5举例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">1.将1.2.840.113549.2.5转换成字数组 &#123;42, 840, 113549, 2, 5&#125;（因为前两部分定义为1.2，那么合成一个字40x1+2=42）</span><br><span class="line"></span><br><span class="line">2.将每个字分割为带有最高位的7位数字。</span><br><span class="line">42=42，只有一个7位数字,那么最高为0，结果为&#123;0x2A&#125;</span><br><span class="line"></span><br><span class="line">840= 6*128^1+72，除最后一个字节外,其他字节的BIT8都置1，结果为&#123;0x86,0x48&#125;</span><br><span class="line"></span><br><span class="line">113549=6*128^2+119*128^1+13，除最后一个字节外,其他字节的BIT8都置1，结果为&#123;0x86,0xF7,0x0D&#125;</span><br><span class="line"></span><br><span class="line">2=2, 只有一个7位数字,那么最高为0，结果为&#123;0x02&#125;</span><br><span class="line"></span><br><span class="line">5=5, 只有一个7位数字,那么最高为0，结果为&#123;0x05&#125;</span><br><span class="line"></span><br><span class="line">最终结果为&#123;&#123;0x2A&#125;,&#123;0x86,0x48&#125;,&#123;0x86,0xF7,0x0D&#125;,&#123;0x02&#125;,&#123;0x05&#125;&#125;</span><br><span class="line"></span><br><span class="line">3.加上TAG和LEN，得到OID编码为 0x06 08 2A 86 48 86 F7 0D 02 05</span><br></pre></td></tr></table></figure>
<p>常见的HASH算法在用于RSA签名时的BER数据编码格式：</p>
<table>
<thead>
<tr>
<th>hash算法</th>
<th>十进制数据</th>
<th>BER数据编码</th>
</tr>
</thead>
<tbody><tr>
<td>MD2</td>
<td>1.2.840.113549.2.2</td>
<td>30 20 30 0c 06 08 2a 86 48 86 f7 0d 02 02 05 00 04 10</td>
</tr>
<tr>
<td>MD4</td>
<td>1.2.840.113549.2.4</td>
<td>30 20 30 0c 06 08 2a 86 48 86 f7 0d 02 04 05 00 04 10</td>
</tr>
<tr>
<td>MD5</td>
<td>1.2.840.113549.2.5</td>
<td>30 20 30 0c 06 08 2a 86 48 86 f7 0d 02 05 05 00 04 10</td>
</tr>
<tr>
<td>SHA1</td>
<td>1.3.14.3.2.26</td>
<td>30 21 30 09 06 05 2b 0e 03 02 1a 05 00 04 14</td>
</tr>
<tr>
<td>SHA224</td>
<td>2.16.840.1.101.3.4.2.4</td>
<td>30 2D 30 0d 06 09 60 86 48 01 65 03 04 02 04 05 00 04 1C</td>
</tr>
<tr>
<td>SHA256</td>
<td>2.16.840.1.101.3.4.2.1</td>
<td>30 31 30 0d 06 09 60 86 48 01 65 03 04 02 01 05 00 04 20</td>
</tr>
<tr>
<td>SHA384</td>
<td>2.16.840.1.101.3.4.2.2</td>
<td>30 41 30 0d 06 09 60 86 48 01 65 03 04 02 02 05 00 04 30</td>
</tr>
<tr>
<td>SHA512</td>
<td>2.16.840.1.101.3.4.2.3</td>
<td>30 51 30 0d 06 09 60 86 48 01 65 03 04 02 03 05 00 04 40</td>
</tr>
<tr>
<td>SM3</td>
<td>1.2.156.197.1.504</td>
<td>30 30 30 0c 06 08 2a 81 1C 81 45 01 83 78 05 00 04 20</td>
</tr>
</tbody></table>
<h3 id="ECDSA签名"><a href="#ECDSA签名" class="headerlink" title="ECDSA签名"></a>ECDSA签名</h3><p>ECDSA签名和验签过程在上一篇文章中介绍过：<br><a href="https://www.mrbluyee.com/2018/12/04/ECDSA%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/">ECDSA非对称加密算法</a></p>
<p>ECDSA的签名是( r, s)两个数值，签名中直接以BER编码方式存储这两个值。<br>例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">signature:</span><br><span class="line">[&#x27;0x30&#x27;, &#x27;0x65&#x27;, &#x27;0x2&#x27;, &#x27;0x30&#x27;, &#x27;0x33&#x27;, &#x27;0xdf&#x27;, &#x27;0xb5&#x27;, &#x27;0xb2&#x27;, &#x27;0x8a&#x27;, &#x27;0x8a&#x27;, &#x27;0xd5&#x27;, &#x27;0x49&#x27;, &#x27;0x21&#x27;, &#x27;0xe4&#x27;, &#x27;0x50&#x27;, &#x27;0xc0&#x27;, &#x27;0xf6&#x27;, &#x27;0x8a&#x27;, &#x27;0x38&#x27;, &#x27;0x58&#x27;, &#x27;0xdb&#x27;, &#x27;0xd8&#x27;, &#x27;0x92&#x27;, &#x27;0x7&#x27;, &#x27;0x80&#x27;, &#x27;0x41&#x27;, &#x27;0x8b&#x27;, &#x27;0xcc&#x27;, &#x27;0xe8&#x27;, &#x27;0xbb&#x27;, &#x27;0xa9&#x27;, &#x27;0x16&#x27;, &#x27;0xf8&#x27;, &#x27;0xf&#x27;, &#x27;0xd&#x27;, &#x27;0x32&#x27;, &#x27;0x35&#x27;, &#x27;0xa1&#x27;, &#x27;0xdf&#x27;, &#x27;0x24&#x27;, &#x27;0xcd&#x27;, &#x27;0xc8&#x27;, &#x27;0x49&#x27;, &#x27;0x86&#x27;, &#x27;0x76&#x27;, &#x27;0xad&#x27;, &#x27;0xe1&#x27;, &#x27;0x22&#x27;, &#x27;0xe&#x27;, &#x27;0xfa&#x27;, &#x27;0xfb&#x27;, &#x27;0x2&#x27;, &#x27;0x2&#x27;, &#x27;0x31&#x27;, &#x27;0x0&#x27;, &#x27;0xc9&#x27;, &#x27;0x4b&#x27;, &#x27;0xbb&#x27;, &#x27;0xa1&#x27;, &#x27;0xbe&#x27;, &#x27;0xc&#x27;, &#x27;0x2d&#x27;, &#x27;0xc9&#x27;, &#x27;0xfe&#x27;, &#x27;0xfc&#x27;, &#x27;0x6f&#x27;, &#x27;0x60&#x27;, &#x27;0xf3&#x27;, &#x27;0x64&#x27;, &#x27;0xe5&#x27;, &#x27;0x7a&#x27;, &#x27;0x2c&#x27;, &#x27;0x50&#x27;, &#x27;0x4f&#x27;, &#x27;0x1f&#x27;, &#x27;0xb0&#x27;, &#x27;0xc8&#x27;, &#x27;0x6d&#x27;, &#x27;0x76&#x27;, &#x27;0xbd&#x27;, &#x27;0x37&#x27;, &#x27;0x3b&#x27;, &#x27;0x4f&#x27;, &#x27;0xfb&#x27;, &#x27;0x97&#x27;, &#x27;0x27&#x27;, &#x27;0x19&#x27;, &#x27;0xe2&#x27;, &#x27;0x4c&#x27;, &#x27;0xf5&#x27;, &#x27;0xee&#x27;, &#x27;0xb2&#x27;, &#x27;0x21&#x27;, &#x27;0x91&#x27;, &#x27;0x79&#x27;, &#x27;0x69&#x27;, &#x27;0x51&#x27;, &#x27;0xd1&#x27;, &#x27;0x45&#x27;, &#x27;0x4f&#x27;, &#x27;0x6f&#x27;, &#x27;0xac&#x27;, &#x27;0x28&#x27;]</span><br><span class="line"></span><br><span class="line">分析：</span><br><span class="line">message_sign message:</span><br><span class="line">SEQ</span><br><span class="line">len: 101</span><br><span class="line">content:</span><br><span class="line">0x2,0x30,0x33,0xdf,0xb5,0xb2,0x8a,0x8a,0xd5,0x49,0x21,0xe4,0x50,0xc0,0xf6,0x8a,0x38,0x58,0xdb,0xd8,0x92,0x7,0x80,0x41,0x8b,0xcc,0xe8,0xbb,0xa9,0x16,0xf8,0xf,0xd,0x32,0x35,0xa1,0xdf,0x24,0xcd,0xc8,0x49,0x86,0x76,0xad,0xe1,0x22,0xe,0xfa,0xfb,0x2,0x2,0x31,0x0,0xc9,0x4b,0xbb,0xa1,0xbe,0xc,0x2d,0xc9,0xfe,0xfc,0x6f,0x60,0xf3,0x64,0xe5,0x7a,0x2c,0x50,0x4f,0x1f,0xb0,0xc8,0x6d,0x76,0xbd,0x37,0x3b,0x4f,0xfb,0x97,0x27,0x19,0xe2,0x4c,0xf5,0xee,0xb2,0x21,0x91,0x79,0x69,0x51,0xd1,0x45,0x4f,0x6f,0xac,0x28</span><br><span class="line"></span><br><span class="line">INT</span><br><span class="line">len: 48</span><br><span class="line">content:</span><br><span class="line">0x33,0xdf,0xb5,0xb2,0x8a,0x8a,0xd5,0x49,0x21,0xe4,0x50,0xc0,0xf6,0x8a,0x38,0x58,0xdb,0xd8,0x92,0x7,0x80,0x41,0x8b,0xcc,0xe8,0xbb,0xa9,0x16,0xf8,0xf,0xd,0x32,0x35,0xa1,0xdf,0x24,0xcd,0xc8,0x49,0x86,0x76,0xad,0xe1,0x22,0xe,0xfa,0xfb,0x2</span><br><span class="line">int val:</span><br><span class="line">7984118745046642712070940994226527427165301776521416471029518628654486337875805051425722475318955077043620618631938</span><br><span class="line"></span><br><span class="line">INT</span><br><span class="line">len: 49</span><br><span class="line">content:</span><br><span class="line">0x0,0xc9,0x4b,0xbb,0xa1,0xbe,0xc,0x2d,0xc9,0xfe,0xfc,0x6f,0x60,0xf3,0x64,0xe5,0x7a,0x2c,0x50,0x4f,0x1f,0xb0,0xc8,0x6d,0x76,0xbd,0x37,0x3b,0x4f,0xfb,0x97,0x27,0x19,0xe2,0x4c,0xf5,0xee,0xb2,0x21,0x91,0x79,0x69,0x51,0xd1,0x45,0x4f,0x6f,0xac,0x28</span><br><span class="line">int val:</span><br><span class="line">30982264106513726684219845244978923429128158159747238210412885484291235505874905425357164893263783009371945614421032</span><br></pre></td></tr></table></figure>

<h4 id="python-部分代码"><a href="#python-部分代码" class="headerlink" title="python 部分代码"></a>python 部分代码</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line">解析signature到print输出:</span><br><span class="line"></span><br><span class="line">    def print_sign_message(self,signature):</span><br><span class="line">        ber_tag = BER_TAG().BER_Tag</span><br><span class="line">        bytes_index = 0</span><br><span class="line">        while bytes_index &lt; len(signature):</span><br><span class="line">            if signature[bytes_index] in ber_tag: </span><br><span class="line">                tag_index = signature[bytes_index]</span><br><span class="line">                print(ber_tag[tag_index])</span><br><span class="line">                bytes_index = bytes_index + 1</span><br><span class="line">                tag_len = int(signature[bytes_index])</span><br><span class="line">                print(&quot;len: &quot; + str(tag_len))</span><br><span class="line">                bytes_index = bytes_index + 1 </span><br><span class="line">                print(&quot;content:&quot;)</span><br><span class="line">                print(&#x27;,&#x27;.join([hex(i) for i in signature[bytes_index:bytes_index+tag_len]]))</span><br><span class="line">                if tag_index == 0x02: # INT</span><br><span class="line">                    print(&quot;int val:&quot;)</span><br><span class="line">                    print(int.from_bytes(signature[bytes_index:bytes_index+tag_len], byteorder=&#x27;big&#x27;, signed=False))</span><br><span class="line">                self.print_sign_message(signature[bytes_index:bytes_index+tag_len])</span><br><span class="line">                bytes_index = bytes_index + tag_len</span><br><span class="line">            else:</span><br><span class="line">                break</span><br><span class="line"></span><br><span class="line">解析signature输出[r,s]:</span><br><span class="line"></span><br><span class="line">    def __decode_signature(self,signature):</span><br><span class="line">        ber_tag = BER_TAG().BER_Tag</span><br><span class="line">        bytes_index = 0</span><br><span class="line">        while bytes_index &lt; len(signature):</span><br><span class="line">            if signature[bytes_index] in ber_tag: </span><br><span class="line">                tag_index = signature[bytes_index]</span><br><span class="line">                #print(ber_tag[tag_index])</span><br><span class="line">                bytes_index = bytes_index + 1</span><br><span class="line">                tag_len = int(signature[bytes_index])</span><br><span class="line">                #print(&quot;len: &quot; + str(tag_len))</span><br><span class="line">                bytes_index = bytes_index + 1 </span><br><span class="line">                #print(&quot;content:&quot;)</span><br><span class="line">                #print(&#x27;,&#x27;.join([hex(i) for i in signature[bytes_index:bytes_index+tag_len]]))</span><br><span class="line">                if tag_index == 0x02: # INT</span><br><span class="line">                    self.__sign_r_s.append(signature[bytes_index:bytes_index+tag_len])</span><br><span class="line">                    #print(&quot;int val:&quot;)</span><br><span class="line">                    #print(int.from_bytes(signature[bytes_index:bytes_index+tag_len], byteorder=&#x27;big&#x27;, signed=False))</span><br><span class="line">                self.__decode_signature(signature[bytes_index:bytes_index+tag_len])</span><br><span class="line">                bytes_index = bytes_index + tag_len</span><br><span class="line">            else:</span><br><span class="line">                break</span><br><span class="line"></span><br><span class="line">    def decode_signature(self,signature):</span><br><span class="line">        self.__sign_r_s = []</span><br><span class="line">        self.__decode_signature(signature)</span><br><span class="line">        return self.__sign_r_s</span><br><span class="line"></span><br><span class="line">将[r,s]合并为signature:</span><br><span class="line"></span><br><span class="line">    def encode_to_signature(self,r_bytes,s_bytes):</span><br><span class="line">        if r_bytes[0] &amp; 0x80:</span><br><span class="line">            int_r = 0x02.to_bytes(1, byteorder= &#x27;big&#x27;) + \</span><br><span class="line">            (len(r_bytes) + 1).to_bytes(1, byteorder= &#x27;big&#x27;) + \</span><br><span class="line">            0x00.to_bytes(1, byteorder= &#x27;big&#x27;) + r_bytes</span><br><span class="line">        else:</span><br><span class="line">            int_r = 0x02.to_bytes(1, byteorder= &#x27;big&#x27;) + \</span><br><span class="line">            len(r_bytes).to_bytes(1, byteorder= &#x27;big&#x27;) + r_bytes</span><br><span class="line">        if s_bytes[0] &amp; 0x80:</span><br><span class="line">            int_s = 0x02.to_bytes(1, byteorder= &#x27;big&#x27;) + \</span><br><span class="line">            (len(s_bytes) + 1).to_bytes(1, byteorder= &#x27;big&#x27;) + \</span><br><span class="line">            0x00.to_bytes(1, byteorder= &#x27;big&#x27;) + s_bytes</span><br><span class="line">        else:</span><br><span class="line">            int_s = 0x02.to_bytes(1, byteorder= &#x27;big&#x27;) + \</span><br><span class="line">            len(s_bytes).to_bytes(1, byteorder= &#x27;big&#x27;) + s_bytes </span><br><span class="line">        int_r_s = int_r + int_s</span><br><span class="line">        return 0x30.to_bytes(1, byteorder= &#x27;big&#x27;) + len(int_r_s).to_bytes(1, byteorder= &#x27;big&#x27;) + int_r_s   </span><br><span class="line"></span><br><span class="line">BER_TAG定义：</span><br><span class="line"></span><br><span class="line"># -*- coding: UTF-8 -*-</span><br><span class="line"></span><br><span class="line">__author__ = &#x27;Mr.Bluyee&#x27;</span><br><span class="line"></span><br><span class="line">class BER_TAG(object):</span><br><span class="line"></span><br><span class="line">    &quot;&quot;&quot;docstring for BER_TAG&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">    BER_Tag = &#123;</span><br><span class="line">        0x01 : &quot;BOOL&quot;,  # BOOL</span><br><span class="line">        0x02 : &quot;INT&quot;,  # 整型</span><br><span class="line">        0x04 : &quot;OCTSTR&quot;,  # 字符串类型</span><br><span class="line">        0x05 : &quot;NULL&quot;,  # 空类型</span><br><span class="line">        0x06 : &quot;OBJID&quot;,  # 对象标识ObjectID（在这里就是对应的HASH算法的OID编码）</span><br><span class="line">        0x0A : &quot;ENUM&quot;,  # ENUM</span><br><span class="line">        0x30 : &quot;SEQ&quot;,  # Sequence组合类型</span><br><span class="line">        0x31 : &quot;SETOF&quot;,</span><br><span class="line">        0x40 : &quot;IPADDR&quot;,</span><br><span class="line">        0x41 : &quot;COUNTER&quot;,</span><br><span class="line">        0x42 : &quot;GAUGE&quot;,</span><br><span class="line">        0x43 : &quot;TIMETICKS&quot;,</span><br><span class="line">        0x44 : &quot;OPAQUE&quot;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(BER_TAG, self).__init__()</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>附：<br>int数值的长度应等于对应的密钥参数的长度，<br>但在有些情况下，bytes最前面总会多一个0的原因：</p>
<p>密钥的长int型数据都是以big endian转为bytes。<br>有些值转为bytes，在bytes第一个字节，最高位上为1。<br>在有些默认处理signed的机器上，为了避免机器处理为负数，则又在前面添加了一个0，这样转换出来的数的最高位就不是1。当然，如果强制把该值处理为unsigned型，就没有这个问题。</p>
<p>部分内容整理自：<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/jintianhu/p/5051169.html">RSA签名验签学习笔记</a></p>
</div><div class="post-copyright"><script type="text/javascript" src="/js/copyright.js?v=1.0.0" successtext="复制成功！"></script><link rel="stylesheet" type="text/css" href="/css/copyright.css?v=1.0.0"><p><span>本文标题：</span>RSA与ECDSA的签名分析</p><p><span>文章作者：</span>Mr Bluyee</p><p><span>发布时间：</span>2018-12-06</p><p><span>最后更新：</span>2019-07-15</p><p><span>原始链接：</span><a href="/2018/12/06/RSA与ECDSA的签名分析/">https://www.mrbluyee.com/2018/12/06/RSA%E4%B8%8EECDSA%E7%9A%84%E7%AD%BE%E5%90%8D%E5%88%86%E6%9E%90/</a><span class="copy-path"><i class="fa fa-clipboard" data-clipboard-text="https://www.mrbluyee.com/2018/12/06/RSA%E4%B8%8EECDSA%E7%9A%84%E7%AD%BE%E5%90%8D%E5%88%86%E6%9E%90/"></i></span></p><p><span>版权声明：</span>The author owns the copyright, please indicate the source reproduced.</p></div><br><div class="tags"><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Python/" rel="tag">Python</a></li></ul></div><div class="post-nav"><a class="pre" href="/2018/12/08/%E5%B5%8C%E5%85%A5%E5%BC%8FLinux%E7%B3%BB%E7%BB%9F%E4%B9%8BBootloader/">嵌入式Linux系统之Bootloader</a><a class="next" href="/2018/12/04/ECDSA%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/">ECDSA非对称加密算法</a></div><div id="lv-container" data-id="city" data-uid="MTAyMC8zOTYxNS8xNjE0Mg"><script>(function(d, s) {
  var j, e = d.getElementsByTagName(s)[0];
  if (typeof LivereTower === 'function') { return; }
  j = d.createElement(s);
  j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
  j.async = true;
  e.parentNode.insertBefore(j, e);
})(document, 'script');
</script></div></div></div></div><div class="pure-u-1 pure-u-md-1-4"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="author-info"><a class="info-avatar" href="/about/" title="关于"><img class="nofancybox" src="/img/avatar.jpeg"/></a><p>Enjoy life / Hope for future</p><a class="info-icon" href="mr.bluyee@hotmail.com" title="mr.bluyee@hotmail.com" target="_blank" style="margin-inline:5px"> <i class="fa fa-envelope-square" style="margin-inline:5px"></i></a><a class="info-icon" href="https://github.com/MrBluyee" title="https://github.com/MrBluyee" target="_blank" style="margin-inline:5px"> <i class="fa fa-github-square" style="margin-inline:5px"></i></a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94C-%E7%AE%97%E6%B3%95/">学习笔记——C 算法</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94C%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">学习笔记——C数据结构</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94Python/">学习笔记——Python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94android/">学习笔记——android</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94data-compression/">学习笔记——data compression</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94expert-c-programming/">学习笔记——expert c programming</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94linux/">学习笔记——linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94opencv/">学习笔记——opencv</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E4%BB%A3%E7%A0%81%E7%AE%A1%E7%90%86/">学习笔记——代码管理</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E4%BD%8E%E5%8A%9F%E8%80%97%E6%8A%80%E6%9C%AF/">学习笔记——低功耗技术</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/">学习笔记——嵌入式开发</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">学习笔记——机器学习</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E7%89%A9%E8%81%94%E7%BD%91/">学习笔记——物联网</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/">学习笔记——网络协议</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/">学习笔记——计算机系统</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/" style="font-size: 15px;">计算机系统</a> <a href="/tags/android/" style="font-size: 15px;">android</a> <a href="/tags/C/" style="font-size: 15px;">C</a> <a href="/tags/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/" style="font-size: 15px;">网络协议</a> <a href="/tags/Python/" style="font-size: 15px;">Python</a> <a href="/tags/linux/" style="font-size: 15px;">linux</a> <a href="/tags/%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91/" style="font-size: 15px;">嵌入式开发</a> <a href="/tags/data-compression/" style="font-size: 15px;">data compression</a> <a href="/tags/opencv/" style="font-size: 15px;">opencv</a> <a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" style="font-size: 15px;">机器学习</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2024/03/23/deflate%20format/">deflate format</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/09/23/IPsec/">IPsec</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/21/%E6%95%B0%E7%9A%84%E7%B4%A0%E6%80%A7%E6%B5%8B%E8%AF%95/">数的素性测试</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/20/%E6%89%A9%E5%B1%95%E7%9A%84%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%AE%97%E6%B3%95/">扩展的欧几里得算法</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/17/%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%AE%97%E6%B3%95-%E6%B1%82%E6%9C%80%E5%A4%A7%E5%85%AC%E5%9B%A0%E6%95%B0/">欧几里得算法-求最大公因数</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/04/%E5%B8%B8%E7%94%A8%E8%B7%AF%E7%94%B1%E6%96%B9%E5%BC%8F/">常用路由方式</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/19/%E6%97%A0%E7%BA%BF%E4%BC%A0%E6%84%9F%E7%BD%91WSN%E6%A6%82%E8%BF%B0/">无线传感网WSN概述</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/18/%E6%97%A0%E7%BA%BF%E6%A8%A1%E5%9D%97%E4%BC%91%E7%9C%A0%E4%B8%8E%E6%BF%80%E6%B4%BB%E6%9C%BA%E5%88%B6/">无线模块休眠与激活机制</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/16/SOC%E7%9A%84%E4%BD%8E%E5%8A%9F%E8%80%97%E8%AE%BE%E8%AE%A1/">SOC的低功耗设计</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/03/%E7%94%B5%E6%BA%90%E7%AE%A1%E7%90%86%E7%9A%84%E4%BD%8E%E5%8A%9F%E8%80%97/">电源管理的低功耗</a></li></ul></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2024 <a href="/." rel="nofollow">Mr Bluyee's Blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/latest/jquery.fancybox.min.js"></script><script type="text/javascript" src="/js/fancybox.js?v=1.0.0"></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/latest/jquery.fancybox.min.css"><link rel="stylesheet" type="text/css" href="/css/search.css?v=1.0.0"><script type="text/javascript" src="/js/search.js?v=1.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
  search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/copycode.js?v=1.0.0" successtext="复制成功！"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css?v=1.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script></div></body></html>